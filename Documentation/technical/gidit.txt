git-gidit-daemon
=============

Overall operation
-----------------

. Connects to the gidit cloud and handles bundle send/receiving

. Learns what refs the cloud has and what is needed, pulls in 
  what is needed, and forwards off to the git client.

. Daemon runs, and participates in cloud operations while 
  waiting for actions from local git clients.


Git Daemon
----------

The DHT cloud stores two main types of objects, PushObjects, and
bundles. 

PushObjects are looked up through a PGP key, and ProjectName. The PGP
key allows for unique identification of an individuals. The
ProjectName identifies an individuals branch. This lookup should
return all PushObjects for a given PGP key and ProjectName in sorted
order (older PushObjects later).

Bundles are looked up through a Start SHA1 and an End SHA1.


Storage Layout
--------------

Default base dir is '/var/gidit'

PushObjects, since they are looked up through PGP and ProjectName,
would be stored in files stored in folders by their PGP keys.

The file structure would be:

./pushobjects/[PGP Key]/ProjectName.plist

The ProjectName file would hold the PushObjects in sorted order.


Bundles would be stored similar to how git stores objects. A folder 
of the two char SHA1 prefix, followed by a folder consisting of the 
rest of the SHA1 hash. The bundle would be stored inside of the folder 
with the name of the end SHA1.

./bundles/[Start SHA1 0..2]/[Start SHA1 2..20]/[End SHA1]


PushObjects
-----------

A PushObject is simply a snapshot of a repository (including all
relevant refs) during a push. It holds a list of SHA1s for each
tag/branch being pushed.

An example of the contents of a PushObject:

52e71bbf899addb4cadd0d7936a281223094ac50 HEAD
52e71bbf899addb4cadd0d7936a281223094ac50 refs/heads/daemon
050b90e8d3823122958daa45f14dde8ede1f76dd refs/heads/master
050b90e8d3823122958daa45f14dde8ede1f76dd refs/heads/working
